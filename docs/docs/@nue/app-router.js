import{onclick as b,loadPage as d,setSelected as k} from"./page-router.js";async function n(t){for(let{pattern:h,fn:o}of a){const r=s(h,t);if(r)await o(r)}k(t)}var s=function(t,h,o){const r=t.split("/").slice(1),f=h.split("/").slice(1);if(!o&&r.length!=f.length)return null;let i=!0;const m={};return r.forEach((c,L)=>{const l=f[L];if(c[0]==":"){if(l)m[c.slice(1)]=1*l||l}else if(!o&&c!=l)i=!1}),i?m:null},a=[];addEventListener("before:route",()=>{a.splice(0,a.length)});var v={on(t,h){a.push({pattern:t,fn:h})},start({path:t,root:h}){if(h)b(h,this.route);this.pattern=t,n(location.pathname)},route(t){scrollTo(0,0);const h=t.endsWith(".html");history.pushState({path:t,is_spa:!h},0,t),h?d(t):n(t)},set(t,h){const o=new URLSearchParams(location.search);o.set(t,h),history.replaceState(v.data,0,`?${o}`)},get data(){const{pattern:t}=this,h=t?s(t,location.pathname,!0):{},o=Object.fromEntries(new URLSearchParams(location.search));return{...h,...o}}};export{v as router,s as match};
